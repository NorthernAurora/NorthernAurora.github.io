<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" >

<title>浅谈C语言整型与浮点型转换 | Module</title>

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://NorthernAurora.github.io/favicon.ico?v=1592369231847">
<link rel="stylesheet" href="https://NorthernAurora.github.io/styles/main.css">


  
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css" />
  

  


<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>



    <meta name="description" content="前言：天才惹人羡慕，可从什么时候开始，愚者的不懈努力也成为大家所嫉妒的东西呢？（请不要在意，这只是来自愚者的自嘲，呵呵）
本篇博客将阐述、讨论的内容：
●int
      int的范围根据计算机的不同存在16位或32位的差异，以16位举例..." />
    <meta name="keywords" content="" />
  </head>
  <body>
    <div id="app" class="main">

      <div class="sidebar" :class="{ 'full-height': menuVisible }">
  <div class="top-container" data-aos="fade-right">
    <div class="top-header-container">
      <a class="site-title-container" href="https://NorthernAurora.github.io">
        <img src="https://NorthernAurora.github.io/images/avatar.png?v=1592369231847" class="site-logo">
        <h1 class="site-title">Module</h1>
      </a>
      <div class="menu-btn" @click="menuVisible = !menuVisible">
        <div class="line"></div>
      </div>
    </div>
    <div>
      
        
          <a href="/" class="site-nav">
            首页
          </a>
        
      
        
          <a href="/archives" class="site-nav">
            归档
          </a>
        
      
        
          <a href="/tags" class="site-nav">
            标签
          </a>
        
      
        
          <a href="/post/about" class="site-nav">
            关于
          </a>
        
      
    </div>
  </div>
  <div class="bottom-container" data-aos="flip-up" data-aos-offset="0">
    <div class="social-container">
      
        
          <a class="social-link" href="https://github.com/NorthernAurora" target="_blank">
            <i class="fab fa-github"></i>
          </a>
        
      
        
          <a class="social-link" href="https://twitter.com/WaterDust1?s=09" target="_blank">
            <i class="fab fa-twitter"></i>
          </a>
        
      
        
          <a class="social-link" href="https://weibo.com/VinRPGMaker?is_all=1" target="_blank">
            <i class="fab fa-weibo"></i>
          </a>
        
      
        
          <a class="social-link" href="https://www.zhihu.com/people/si-yuan-62-35" target="_blank">
            <i class="fab fa-zhihu"></i>
          </a>
        
      
        
          <a class="social-link" href="https://www.facebook.com/profile.php?id=100046713451146" target="_blank">
            <i class="fab fa-facebook"></i>
          </a>
        
      
    </div>
    <div class="site-description">
      芝兰生于深林，不以无人而不芳。
    </div>
    <div class="site-footer">
      
Powered by <a href="https://northernaurora.github.io/" target="_blank">Vin</a> | <a class="rss" href="https://NorthernAurora.github.io/atom.xml" target="_blank">RSS</a>
    </div>
  </div>
</div>


      <div class="main-container">
        <div class="content-container" data-aos="fade-up">
          <div class="post-detail">
            <h2 class="post-title">浅谈C语言整型与浮点型转换</h2>
            <div class="post-date">2020-06-11</div>
            
            <div class="post-content" v-pre>
              <p><strong>前言：天才惹人羡慕，可从什么时候开始，愚者的不懈努力也成为大家所嫉妒的东西呢？</strong>（请不要在意，这只是来自愚者的自嘲，呵呵）</p>
<p><strong>本篇博客将阐述、讨论的内容：</strong><img src="https://NorthernAurora.github.io/post-images/1591872642224.png" alt="" loading="lazy"><br>
●<strong>int</strong><br>
      int的范围根据计算机的不同存在16位或32位的差异，以16位举例，最大值为1111 1111 1111 1111，也就是65535，如果出现65536，就会溢出。<br>
     ●<strong>unsigned int(无符号整型)</strong><br>
      以16位系统为例，unsigned int能存储的数据范围是0~65535（需要注意整数是以补码形式存放）。其进行的是模数计算，也就是所谓的二进制相加减，计算方法和十进制加减并无区别，但是unsigned int有着正溢出和负溢出的问题。<br>
      对于正溢出与负溢出，诸多基础概念便不再赘述，不懂的朋友可以去回顾计算机组成原理的相关知识。<br>
<strong>这里仅举出一个负溢出的例子：</strong><img src="https://NorthernAurora.github.io/post-images/1591886105289.png" alt="" loading="lazy"><br>
进行自然丢弃后，可知结果为0。很明显，产生了负溢出。</p>
<p>     ●接下来，我们说说unsigned int和int的相互转化，代码如下：<img src="https://NorthernAurora.github.io/post-images/1591888581238.png" alt="" loading="lazy"><br>
      很显然，计算一个数组所有元素之和。但当数组为空时，length输入0，会返回一个存储器错误。为什么呢？请看unsigned int的计算，length是unsigned int 类型，进行的是模数运算，只代表正数，如果出先了0000000(这里有32个0)-00000..01(31个0，1个1)=111…11111(32个1)=UMAX。一个本该为-1的数变成了无符号数最大值，当i取任何不为0的数都发生了非法访问，自然出现了存储器错误，并且任何数都小于UMAX，出现判别式永远为真，进入死循环。解决办法有两种，做一个判断，当传入length&lt;1,直接返回0 or 在之前就将length转化为int。<br>
●<strong>浮点数</strong><br>
     ●<strong>定点数以及定点数的缺点</strong><br>
      用10进制表示小数早已司空见惯，那么就会想要对二进制做同样的操作，为它也加上小数点。<img src="https://NorthernAurora.github.io/post-images/1591887069630.png" alt="" loading="lazy"><br>
      但是如此的二进制小数，会出现一些问题不可避免</p>
   <table border = "1">
        <tr>
            <th>整数部分</th>
            <th>小数部分</th>
            <th>二进制（Representation）</th>
        </tr>
        <tr>
            <!--td代表一行无加粗-->
            <td>5</td>
            <td>3/4/td>
            <td>101.11<sub>2</sub></td>
        </tr>
        <tr>
            <td>2</td>
            <td>7/8</td>
            <td>10.111<sub>2</sub></td>
        </tr>
        <tr>
            <td>1</td>
            <td>7/16</td>
            <td>1.0111<sub>2</sub></td>
        </tr>
    </table>
&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;很明显可以发现，只能准确的表示x/2<sup>k</sup>的小数，而不为x/2<sup>k</sup>只能近似。
   <table border = "1">
        <tr>
            <th>十进制小数部分</th>
            <th>二进制（Representation）</th>
        </tr>
        <tr>
            <td>1/3</td>
            <td>0.01010101[01]… <sub>2</sub></td>
        </tr>
        <tr>
            <td>1/5</td>
            <td>0.001100110011[0011]… <sub>2</sub></td>
        </tr>
        <tr>
            <td>1/10</td>
            <td>0.0001100110011[0011]… <sub>2</sub></td>
        </tr>
    </table>
<p>      而为什么会出现如上结果，就要知到1/3 和 1/5是如何计算的。<br>
<img src="https://NorthernAurora.github.io/post-images/1591887931595.png" alt="" loading="lazy"><br>
      由此可见，当小数无法描述x/2<sup>k</sup>时，二进制小数便只能取近似值（多采用close to even(靠近偶数)）。<br>
      这就暴露定点数的一个重要缺点 <strong>----</strong> 定点数无法标准化。也就是说，关于小数点的位置无法给出一个标准的定点数计算方式，不同小数点的位置给计算定点数增加了难度。与此同时，定点数表示的范围有限，32位的定点数，假设没有整数位，那么所能表示的小数的最小值为:2<sup>-32</sup>，而32位浮点数仅指数位便可以表示到2<sup>-126</sup>，由此不难看出，定点数虽然精度高，但标准化和范围大小都比较差。<br>
      所以此时便引出了浮点数来统一二进制小数的表示：<br>
<img src="https://NorthernAurora.github.io/post-images/1591888698920.png" alt="" loading="lazy"><br>
注：s:表示符号位，只用一个bit表示<br>
      M:表示尾数（significand)(frac)也表示小数位，即能准确表示小数位<br>
      E:表示指数位。</p>
<p>      下文重点参考了“写代码的柯长”大佬的文章。<br>
<strong>常用的float,double组成：</strong><img src="https://NorthernAurora.github.io/post-images/1591889176923.png" alt="" loading="lazy"><br>
      可以看出float有8位指数位，23位尾数位。指数最大可表示的范围为-127～126<br>
浮点数所表示的一个范围：<img src="https://NorthernAurora.github.io/post-images/1591889257858.png" alt="" loading="lazy"><br>
      有图可以得到，浮点数随着大小的不同被分为不同种类，接近0的称为Denormalized，较大的数字被分为Infinity。（关于Denormalized、Infinity等名词请自行了解，这里不再做过多的赘述）。</p>
<p><strong>Normailized，Denormalized，Infinity,NaN：</strong><img src="https://NorthernAurora.github.io/post-images/1591890225325.png" alt="" loading="lazy"><br>
<strong>Denormalized到NaN的变化：</strong><img src="https://NorthernAurora.github.io/post-images/1591890246544.png" alt="" loading="lazy"></p>
<p><strong>浮点数相加的公式：</strong><img src="https://NorthernAurora.github.io/post-images/1591890618423.png" alt="" loading="lazy"><br>
      浮点数的加法和乘法由于近似的原因，经常无法实现加法的结合律和乘法分配律，如下所示：<br>
(3.14+le10)-1e10=0.0,因为3.14+1e10会舍入，3.14会丢失（1e10表示1<em>101010）<br>
然而3.14+（1e10-1e10）=3.14<br>
le20</em>(le20-le20)=0.0<br>
le20<em>le20-le20</em>le20=NaN，由于溢出的关系，可见在数字大的情况下不满足加法结合律和乘法分配律。</p>
<p><strong>最后，关于int，float，double之间相互转换可能的问题：</strong><br>
      当在int，float以及double格式之间进行强制转换时，程序改变数值和位模式的原则如下（假设int为32位）：<br>
     ●从int转换成float，数字不会溢出，但可能被舍入。<br>
     ●从int或float转换成double，因为double有更大的范围（也就是可表示值得范围），也有更高得精度（即有效位数），所以能保留精确得数值。<br>
     ●从double转换成float，因为范围要小一些，所以值可嫩溢出为+∞或-∞。且由于精度较小，它还可能被舍入。<br>
     ●从float或double转换成int，值将会向0舍入。例如1.999将转换为1。进一步说，值可能会溢出。C语言标准没有对这种情况指定固定的结果。而与Inter兼容的微处理器指定位模式[10…00]（字长为ω时的TMinω）为整数不确定值。一个从浮点数到整数的转换，如果不能为该浮点数找到一个合理的整数近似值，就会产生一个这样的值。因此，表达式（int）+le10会得到-21483648，即从一个正值变成了一个负值。</p>
<p>     文章就到此结束，博主这里刚刚发生了地震，且震感明显，我要下楼避难了（逃🏃‍♀）2020/6/12/00：11：00</p>
<p><strong>参考文献：《深入理解计算机系统（原书第3版）》机械工业出版社<br>
参考博主：写代码的柯长（CSDN）、Jamesjiang2050（博客园）</strong></p>

            </div>
            
            
              <div class="next-post">
                <div class="next">下一篇</div>
                <a href="https://NorthernAurora.github.io/post/guan-yu-zai-github-shang-chuan-xiang-mu-de-liu-cheng/">
                  <h3 class="post-title">
                    关于在GitHub上传项目的流程
                  </h3>
                </a>
              </div>
            

            
              
                <div id="gitalk-container" data-aos="fade-in"></div>
              

              
            

          </div>

        </div>
      </div>
    </div>

    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="application/javascript">

AOS.init();

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>





  
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
    <script>

      var gitalk = new Gitalk({
        clientID: '84bd6004cbd68c4eb0f2',
        clientSecret: '45cf45537955d8aeb80f863164aa46fc6ba12501',
        repo: 'NorthernAurora.github.io',
        owner: 'NorthernAurora',
        admin: ['NorthernAurora'],
        id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
        distractionFreeMode: false  // Facebook-like distraction free mode
      })

      gitalk.render('gitalk-container')

    </script>
  

  




  </body>
</html>
